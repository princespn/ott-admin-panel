!function(t){"object"==typeof module&&module.exports?(t.default=t,module.exports=t):"function"==typeof define&&define.amd?define("highcharts/modules/export-data",["highcharts","highcharts/modules/exporting"],function(e){return t(e),t.Highcharts=e,t}):t("undefined"!=typeof Highcharts?Highcharts:void 0)}(function(t){function e(t,e,a,o){t.hasOwnProperty(e)||(t[e]=o.apply(null,a))}e(t=t?t._modules:{},"mixins/ajax.js",[t["parts/Globals.js"],t["parts/Utilities.js"]],function(t,e){var a=e.objectEach;t.ajax=function(e){var o=t.merge(!0,{url:!1,type:"get",dataType:"json",success:!1,error:!1,data:!1,headers:{}},e);e={json:"application/json",xml:"application/xml",text:"text/plain",octet:"application/octet-stream"};var n=new XMLHttpRequest;if(!o.url)return!1;n.open(o.type.toUpperCase(),o.url,!0),o.headers["Content-Type"]||n.setRequestHeader("Content-Type",e[o.dataType]||e.text),a(o.headers,function(t,e){n.setRequestHeader(e,t)}),n.onreadystatechange=function(){if(4===n.readyState){if(200===n.status){var t=n.responseText;if("json"===o.dataType)try{t=JSON.parse(t)}catch(t){return void(o.error&&o.error(n,t))}return o.success&&o.success(t)}o.error&&o.error(n,n.responseText)}};try{o.data=JSON.stringify(o.data)}catch(t){}n.send(o.data||!0)},t.getJSON=function(e,a){t.ajax({url:e,success:a,dataType:"json",headers:{"Content-Type":"text/plain"}})}}),e(t,"mixins/download-url.js",[t["parts/Globals.js"]],function(t){var e=t.win,a=e.navigator,o=e.document,n=e.URL||e.webkitURL||e,r=/Edge\/\d+/.test(a.userAgent);t.dataURLtoBlob=function(t){if((t=t.match(/data:([^;]*)(;base64)?,([0-9A-Za-z+\/]+)/))&&3<t.length&&e.atob&&e.ArrayBuffer&&e.Uint8Array&&e.Blob&&n.createObjectURL){var a=e.atob(t[3]),o=new e.ArrayBuffer(a.length);o=new e.Uint8Array(o);for(var r=0;r<o.length;++r)o[r]=a.charCodeAt(r);return t=new e.Blob([o],{type:t[1]}),n.createObjectURL(t)}},t.downloadURL=function(n,i){var s=o.createElement("a");if("string"==typeof n||n instanceof String||!a.msSaveOrOpenBlob){if((r||2e6<n.length)&&!(n=t.dataURLtoBlob(n)))throw Error("Failed to convert to blob");if(void 0!==s.download)s.href=n,s.download=i,o.body.appendChild(s),s.click(),o.body.removeChild(s);else try{var l=e.open(n,"chart");if(null==l)throw Error("Failed to open window")}catch(t){e.location.href=n}}else a.msSaveOrOpenBlob(n,i)}}),e(t,"modules/export-data.src.js",[t["parts/Globals.js"],t["parts/Utilities.js"]],function(t,e){function a(t,e){var a=s.navigator,o=-1<a.userAgent.indexOf("WebKit")&&0>a.userAgent.indexOf("Chrome"),n=s.URL||s.webkitURL||s;try{if(a.msSaveOrOpenBlob&&s.MSBlobBuilder){var r=new s.MSBlobBuilder;return r.append(t),r.getBlob("image/svg+xml")}if(!o)return n.createObjectURL(new s.Blob(["\ufeff"+t],{type:e}))}catch(t){}}var o=e.defined,n=e.extend,r=e.isObject,i=e.pick,s=t.win,l=s.document,c=t.seriesTypes,p=t.downloadURL,d=t.fireEvent;t.setOptions({exporting:{csv:{columnHeaderFormatter:null,dateFormat:"%Y-%m-%d %H:%M:%S",decimalPoint:null,itemDelimiter:null,lineDelimiter:"\n"},showTable:!1,useMultiLevelHeaders:!0,useRowspanHeaders:!0},lang:{downloadCSV:"Download CSV",downloadXLS:"Download XLS",openInCloud:"Open in Highcharts Cloud",viewData:"View data table"}}),t.addEvent(t.Chart,"render",function(){this.options&&this.options.exporting&&this.options.exporting.showTable&&!this.options.chart.forExport&&this.viewData()}),t.Chart.prototype.setUpKeyToAxis=function(){c.arearange&&(c.arearange.prototype.keyToAxis={low:"y",high:"y"}),c.gantt&&(c.gantt.prototype.keyToAxis={start:"x",end:"x"})},t.Chart.prototype.getDataRows=function(e){var a,n=this.hasParallelCoordinates,r=this.time,s=this.options.exporting&&this.options.exporting.csv||{},l=this.xAxis,c={},p=[],h=[],u=[],f=function(a,o,n){if(s.columnHeaderFormatter){var r=s.columnHeaderFormatter(a,o,n);if(!1!==r)return r}return a?a instanceof t.Axis?a.options.title&&a.options.title.text||(a.isDatetimeAxis?"DateTime":"Category"):e?{columnTitle:1<n?o:a.name,topLevelColumnTitle:a.name}:a.name+(1<n?" ("+o+")":""):"Category"},m=function(e,a,o){var n={},r={};return a.forEach(function(a){var i=(e.keyToAxis&&e.keyToAxis[a]||a)+"Axis";i=t.isNumber(o)?e.chart[i][o]:e[i],n[a]=i&&i.categories||[],r[a]=i&&i.isDatetimeAxis}),{categoryMap:n,dateTimeValueAxisMap:r}},x=[],g=0;for(y in this.setUpKeyToAxis(),this.series.forEach(function(o){var p,d=o.options.keys||o.pointArrayMap||["y"],y=d.length,b=!o.requireSorting&&{},v=l.indexOf(o.xAxis),w=m(o,d);if(!1!==o.options.includeInDataExport&&!o.options.isInternal&&!1!==o.visible){for(t.find(x,function(t){return t[0]===v})||x.push([v,g]),p=0;p<y;)a=f(o,d[p],d.length),u.push(a.columnTitle||a),e&&h.push(a.topLevelColumnTitle||a),p++;var C={chart:o.chart,autoIncrement:o.autoIncrement,options:o.options,pointArrayMap:o.pointArrayMap};o.options.data.forEach(function(t,e){n&&(w=m(o,d,e));var a={series:C};o.pointClass.prototype.applyOptions.apply(a,[t]),t=a.x;var l=o.data[e]&&o.data[e].name;for(p=0,o.xAxis&&"name"!==o.exportKey||(t=l),b&&(b[t]&&(t+="|"+e),b[t]=!0),c[t]||(c[t]=[],c[t].xValues=[]),c[t].x=a.x,c[t].name=l,c[t].xValues[v]=a.x;p<y;)l=a[e=d[p]],c[t][g+p]=i(w.categoryMap[e][l],w.dateTimeValueAxisMap[e]?r.dateFormat(s.dateFormat,l):null,l),p++}),g+=p}}),c)Object.hasOwnProperty.call(c,y)&&p.push(c[y]);var y=e?[h,u]:[u];for(g=x.length;g--;){var b=x[g][0],v=x[g][1],w=l[b];p.sort(function(t,e){return t.xValues[b]-e.xValues[b]});var C=f(w);y[0].splice(v,0,C),e&&y[1]&&y[1].splice(v,0,C),p.forEach(function(t){var e=t.name;w&&!o(e)&&(w.isDatetimeAxis?(t.x instanceof Date&&(t.x=t.x.getTime()),e=r.dateFormat(s.dateFormat,t.x)):e=w.categories?i(w.names[t.x],w.categories[t.x],t.x):t.x),t.splice(v,0,e)})}return y=y.concat(p),d(this,"exportData",{dataRows:y}),y},t.Chart.prototype.getCSV=function(t){var e="",a=this.getDataRows(),o=this.options.exporting.csv,n=i(o.decimalPoint,","!==o.itemDelimiter&&t?1.1.toLocaleString()[1]:"."),r=i(o.itemDelimiter,","===n?";":","),s=o.lineDelimiter;return a.forEach(function(t,o){for(var i,l=t.length;l--;)"string"==typeof(i=t[l])&&(i='"'+i+'"'),"number"==typeof i&&"."!==n&&(i=i.toString().replace(".",n)),t[l]=i;e+=t.join(r),o<a.length-1&&(e+=s)}),e},t.Chart.prototype.getTable=function(t){var e='<table id="highcharts-data-table-'+this.index+'">',a=this.options,o=t?1.1.toLocaleString()[1]:".",n=i(a.exporting.useMultiLevelHeaders,!0);t=this.getDataRows(n);var r=0,s=n?t.shift():null,l=t.shift(),c=function(t,e,a,n){var r=i(n,"");return e="text"+(e?" "+e:""),"number"==typeof r?(r=r.toString(),","===o&&(r=r.replace(".",o)),e="number"):n||(e="empty"),"<"+t+(a?" "+a:"")+' class="'+e+'">'+r+"</"+t+">"};!1!==a.exporting.tableCaption&&(e+='<caption class="highcharts-table-caption">'+i(a.exporting.tableCaption,a.title.text?a.title.text.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;"):"Chart")+"</caption>");for(var p=0,h=t.length;p<h;++p)t[p].length>r&&(r=t[p].length);return e+=function(t,e,o){var r="<thead>",i=0;o=o||e&&e.length;var s,l=0;if(s=n&&t&&e){t:if(s=t.length,e.length===s){for(;s--;)if(t[s]!==e[s]){s=!1;break t}s=!0}else s=!1;s=!s}if(s){for(r+="<tr>";i<o;++i){s=t[i];var p=t[i+1];s===p?++l:l?(r+=c("th","highcharts-table-topheading",'scope="col" colspan="'+(l+1)+'"',s),l=0):(s===e[i]?a.exporting.useRowspanHeaders?(p=2,delete e[i]):(p=1,e[i]=""):p=1,r+=c("th","highcharts-table-topheading",'scope="col"'+(1<p?' valign="top" rowspan="'+p+'"':""),s))}r+="</tr>"}if(e){for(r+="<tr>",i=0,o=e.length;i<o;++i)void 0!==e[i]&&(r+=c("th",null,'scope="col"',e[i]));r+="</tr>"}return r+"</thead>"}(s,l,Math.max(r,l.length)),e+="<tbody>",t.forEach(function(t){e+="<tr>";for(var a=0;a<r;a++)e+=c(a?"td":"th",null,a?"":'scope="row"',t[a]);e+="</tr>"}),d(this,"afterGetTable",t={html:e+="</tbody></table>"}),t.html},t.Chart.prototype.downloadCSV=function(){var t=this.getCSV(!0);p(a(t,"text/csv")||"data:text/csv,\ufeff"+encodeURIComponent(t),this.getFilename()+".csv")},t.Chart.prototype.downloadXLS=function(){var t='<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns="http://www.w3.org/TR/REC-html40"><head>\x3c!--[if gte mso 9]><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet><x:Name>Ark1</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet></x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--\x3e<style>td{border:none;font-family: Calibri, sans-serif;} .number{mso-number-format:"0.00";} .text{ mso-number-format:"@";}</style><meta name=ProgId content=Excel.Sheet><meta charset=UTF-8></head><body>'+this.getTable(!0)+"</body></html>";p(a(t,"application/vnd.ms-excel")||"data:application/vnd.ms-excel;base64,"+s.btoa(unescape(encodeURIComponent(t))),this.getFilename()+".xls")},t.Chart.prototype.viewData=function(){this.dataTableDiv||(this.dataTableDiv=l.createElement("div"),this.dataTableDiv.className="highcharts-data-table",this.renderTo.parentNode.insertBefore(this.dataTableDiv,this.renderTo.nextSibling)),this.dataTableDiv.innerHTML=this.getTable(),d(this,"afterViewData",this.dataTableDiv)},t.Chart.prototype.openInCloud=function(){var e=t.merge(this.userOptions);!function t(e){Object.keys(e).forEach(function(a){"function"==typeof e[a]&&delete e[a],r(e[a])&&t(e[a])})}(e),e={name:e.title&&e.title.text||"Chart title",options:e,settings:{constructor:"Chart",dataProvider:{csv:this.getCSV()}}};var a=JSON.stringify(e);!function(){var t=l.createElement("form");l.body.appendChild(t),t.method="post",t.action="https://cloud-api.highcharts.com/openincloud",t.target="_blank";var e=l.createElement("input");e.type="hidden",e.name="chart",e.value=a,t.appendChild(e),t.submit(),l.body.removeChild(t)}()},(e=t.getOptions().exporting)&&(n(e.menuItemDefinitions,{downloadCSV:{textKey:"downloadCSV",onclick:function(){this.downloadCSV()}},downloadXLS:{textKey:"downloadXLS",onclick:function(){this.downloadXLS()}},viewData:{textKey:"viewData",onclick:function(){this.viewData()}},openInCloud:{textKey:"openInCloud",onclick:function(){this.openInCloud()}}}),e.buttons&&e.buttons.contextButton.menuItems.push("separator","downloadCSV","downloadXLS","viewData","openInCloud")),c.map&&(c.map.prototype.exportKey="name"),c.mapbubble&&(c.mapbubble.prototype.exportKey="name"),c.treemap&&(c.treemap.prototype.exportKey="name")}),e(t,"masters/modules/export-data.src.js",[],function(){})});